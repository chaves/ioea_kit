generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model call_comments {
  id                 BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  comment            String    @db.Text
  call_submission_id BigInt    @db.UnsignedBigInt
  call_reviewer_id   BigInt    @db.UnsignedBigInt
  created_at         DateTime? @db.Timestamp(0)
  updated_at         DateTime? @db.Timestamp(0)

  @@index([call_reviewer_id], map: "call_comments_call_reviewer_id_foreign")
  @@index([call_submission_id], map: "call_comments_call_submission_id_foreign")
}

model call_notes {
  id                 BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  note               Int       @db.UnsignedSmallInt
  call_submission_id BigInt    @db.UnsignedBigInt
  call_reviewer_id   BigInt    @db.UnsignedBigInt
  type               Int       @db.UnsignedTinyInt
  created_at         DateTime? @db.Timestamp(0)
  updated_at         DateTime? @db.Timestamp(0)

  @@index([call_reviewer_id], map: "call_notes_call_reviewer_id_foreign")
  @@index([call_submission_id], map: "call_notes_call_submission_id_foreign")
}

model call_submissions {
  id            BigInt    @id @default(autoincrement()) @db.UnsignedBigInt
  call_year     Int       @default(2023) @db.Year
  last_name     String    @db.VarChar(255)
  first_name    String    @db.VarChar(255)
  nationality   Int
  gender        String    @db.VarChar(255)
  age           Int       @db.SmallInt
  status        Int       @db.TinyInt
  domain        String    @db.VarChar(255)
  diploma       String    @db.VarChar(255)
  email         String    @db.VarChar(255)
  university    String    @db.VarChar(255)
  department    String    @db.VarChar(255)
  country       Int
  title         String    @db.VarChar(255)
  phd_ad_name   String?   @db.VarChar(255)
  phd_year      Int?      @db.Year
  phd_ad_mail   String?   @db.VarChar(255)
  summary       String    @db.Text
  cv            String    @db.VarChar(255)
  paper         String    @db.VarChar(255)
  accepted      Boolean   @default(false)
  call_group_id BigInt?   @db.UnsignedBigInt
  created_at    DateTime? @db.Timestamp(0)
  updated_at    DateTime? @db.Timestamp(0)

  @@index([call_group_id], map: "call_submissions_call_group_id_foreign")
}

model users {
  id                    Int                    @id @default(autoincrement()) @db.UnsignedInt
  email                 String                 @unique(map: "email") @db.VarChar(255)
  password_hash         String?                @db.VarChar(255)
  name                  String                 @db.VarChar(255)
  active                Boolean?               @default(true)
  created_at            DateTime?              @default(now()) @db.DateTime(0)
  updated_at            DateTime?              @default(now()) @updatedAt @db.DateTime(0)
  legacy_reviewer_id    Int?                   @db.UnsignedInt
  legacy_student_id     Int?                   @db.UnsignedInt
  legacy_reviewer_group Int?                   @db.UnsignedTinyInt
  must_change_password  Boolean?               @default(false)
  roles                 user_roles[]
  password_reset_tokens password_reset_tokens[]
  sessions              sessions[]

  @@index([email], map: "idx_email")
}

model password_reset_tokens {
  id         Int       @id @default(autoincrement()) @db.UnsignedInt
  user_id    Int       @db.UnsignedInt
  token_hash String    @unique @db.VarChar(64)
  expires_at DateTime  @db.DateTime(0)
  used_at    DateTime? @db.DateTime(0)
  created_at DateTime  @default(now()) @db.DateTime(0)
  user       users     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "password_reset_tokens_ibfk_1")

  @@index([user_id], map: "idx_prt_user_id")
  @@index([token_hash], map: "idx_prt_token_hash")
}

model sessions {
  token_hash String   @id @db.VarChar(64)
  user_id    Int      @db.UnsignedInt
  expires_at DateTime @db.DateTime(0)
  created_at DateTime @default(now()) @db.DateTime(0)
  user       users    @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "sessions_ibfk_1")

  @@index([user_id], map: "idx_sessions_user_id")
  @@index([expires_at], map: "idx_sessions_expires_at")
}

model roles {
  id          Int          @id @default(autoincrement()) @db.UnsignedInt
  name        String       @unique(map: "name") @db.VarChar(50)
  description String?      @db.VarChar(255)
  created_at  DateTime?    @default(now()) @db.DateTime(0)
  users       user_roles[]

  @@index([name], map: "idx_name")
}

model user_roles {
  id         Int       @id @default(autoincrement()) @db.UnsignedInt
  user_id    Int       @db.UnsignedInt
  role_id    Int       @db.UnsignedInt
  granted_at DateTime? @default(now()) @db.DateTime(0)
  granted_by Int?      @db.UnsignedInt
  user       users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_roles_ibfk_1")
  role       roles     @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "user_roles_ibfk_2")

  @@unique([user_id, role_id], map: "unique_user_role")
  @@index([role_id], map: "idx_role_id")
  @@index([user_id], map: "idx_user_id")
}

model call_reviewers {
  id            BigInt  @id @default(autoincrement()) @db.UnsignedBigInt
  call_group_id BigInt? @db.UnsignedBigInt
  name          String  @db.VarChar(255)
  email         String  @db.VarChar(255)
  slug          String  @db.VarChar(255)

  @@index([call_group_id], map: "call_reviewers_call_group_id_foreign")
}

model chairs {
  id         Int    @id @default(autoincrement()) @db.UnsignedInt
  group_id   Int    @db.TinyInt
  year       Int    @db.Year
  last_name  String @db.VarChar(120)
  first_name String @db.VarChar(120)
  instit     String @db.VarChar(250)
  photo      String @db.VarChar(50)
  home       String @db.VarChar(255)
  email      String @db.VarChar(120)
}

model countries {
  id      Int     @id @default(autoincrement())
  iso     String  @default("") @db.VarChar(2)
  name    String  @default("") @db.VarChar(80)
  iso3    String? @db.VarChar(3)
  numcode Int?    @db.SmallInt
}

model data_transfers {
  id   Int    @id @default(autoincrement()) @db.UnsignedInt
  name String @default("") @db.VarChar(50)
}

model data_villes {
  id   Int    @id @default(autoincrement()) @db.UnsignedInt
  name String @db.VarChar(50)
}

model e_ecoles {
  id_ecole    Int @id @default(autoincrement()) @db.UnsignedTinyInt
  annee       Int @default(0) @db.UnsignedMediumInt
  lectures_id Int @default(0) @db.UnsignedTinyInt

  @@map("e-ecoles")
}

model e_auteurs {
  id     Int    @id @default(autoincrement()) @db.UnsignedInt
  prenom String @default("") @db.VarChar(50)
  nom    String @default("") @db.VarChar(50)
  instit String @default("") @db.VarChar(255)
  home   String @default("") @db.VarChar(255)
  photo  String @default("") @db.VarChar(120)
  email  String @default("") @db.VarChar(255)
}

model e_presentation {
  id        Int    @id @default(autoincrement()) @db.UnsignedInt
  id_auteur Int    @default(0) @db.UnsignedInt
  titre     String @default("") @db.VarChar(255)
  resume    String @db.Text
  lien      String @default("") @db.VarChar(255)
  id_themes Int    @default(0) @db.UnsignedTinyInt
  rang      Int    @default(1) @db.UnsignedTinyInt

  @@index([id_auteur], map: "id_auteur")
  @@index([id_themes], map: "id_themes")
}

model e_references {
  id              Int                   @id @default(autoincrement()) @db.UnsignedInt
  reference       String                @db.Text
  lienref         String                @default("") @db.VarChar(255)
  mustread        e_references_mustread @default(NO)
  id_presentation Int                   @default(0) @db.UnsignedInt
  rank            Int                   @default(1) @db.TinyInt
  past_ref        Int                   @default(0)

  @@index([id_presentation], map: "id_presentation")
}

model e_themes {
  id       Int      @id @default(autoincrement()) @db.UnsignedInt
  theme    String   @db.VarChar(255)
  lecwp    String   @default("lectures") @db.VarChar(50)
  date_new DateTime @db.Date
}

model students {
  id          Int       @id @default(autoincrement()) @db.UnsignedInt
  first_name  String    @db.VarChar(255)
  last_name   String    @db.VarChar(255)
  nationality Int?      @db.UnsignedMediumInt
  gender      String    @db.VarChar(2)
  birth_date  DateTime? @db.Date
  email       String    @db.VarChar(255)
  university  String?   @db.VarChar(255)
  residence   Int       @db.UnsignedMediumInt
  special     String?   @db.VarChar(255)
  photo       String?   @db.VarChar(255)

  @@index([first_name], map: "last_name")
}

model students_groups {
  id         Int @id @default(autoincrement()) @db.UnsignedInt
  student_id Int @db.UnsignedInt
  group_id   Int @db.UnsignedInt

  @@index([student_id, group_id], map: "student_id")
}

model students_papers {
  id         Int    @id @default(autoincrement()) @db.UnsignedInt
  student_id Int    @default(0) @db.UnsignedInt
  type       String @db.VarChar(8)
  title      String @default("") @db.VarChar(255)
  abstract   String @db.Text
  file       String @default("") @db.VarChar(150)
  slides     String @default("") @db.VarChar(150)

  @@index([student_id], map: "student_id")
}

model students_persons {
  id         Int @id @default(autoincrement()) @db.UnsignedInt
  student_id Int @default(0) @db.UnsignedSmallInt
  person_id  Int @default(0) @db.UnsignedSmallInt

  @@index([student_id], map: "student_id")
}

model students_travels {
  id                  Int      @id @default(autoincrement()) @db.UnsignedInt
  student_id          String   @default("") @db.VarChar(150)
  arrival_date_time   DateTime @default(dbgenerated("'0000-00-00 00:00:00'")) @db.DateTime(0)
  arrival_transport   String   @db.VarChar(8)
  arrival_location    String   @default("") @db.VarChar(20)
  arrival_flight      String   @default("") @db.VarChar(255)
  arrival_transfer    Int      @default(0) @db.UnsignedTinyInt
  departure_date_time DateTime @default(dbgenerated("'0000-00-00 00:00:00'")) @db.DateTime(0)
  departure_transport String   @db.VarChar(8)
  departure_location  String   @default("") @db.VarChar(20)
  departure_flight    String   @default("") @db.VarChar(255)
  departure_transfer  Int      @default(0) @db.UnsignedTinyInt
  check               Int      @default(0) @db.UnsignedTinyInt
}

model students_travels_locations {
  id       Int    @id @default(autoincrement())
  location String @db.VarChar(128)
}

model students_travels_transfer {
  id       Int    @id @default(autoincrement())
  transfer String @db.VarChar(128)
}

model call_evaluation_types {
  id   BigInt @id @default(autoincrement()) @db.UnsignedBigInt
  name String @db.VarChar(255)
}

model call_groups {
  id   BigInt @id @default(autoincrement()) @db.UnsignedBigInt
  year Int    @db.Year
  name String @db.VarChar(255)
}

model call_reviewer_call_submissions {
  id                 BigInt @id @default(autoincrement()) @db.UnsignedBigInt
  call_submission_id BigInt @db.UnsignedBigInt
  call_reviewer_id   BigInt @db.UnsignedBigInt

  @@index([call_reviewer_id], map: "call_reviewer_call_submissions_call_reviewer_id_foreign")
  @@index([call_submission_id], map: "call_reviewer_call_submissions_call_submission_id_foreign")
}

model call_statuses {
  id   BigInt @id @default(autoincrement()) @db.UnsignedBigInt
  name String @db.VarChar(255)
}

enum e_references_mustread {
  NO  @map("0")
  YES @map("1")
}
